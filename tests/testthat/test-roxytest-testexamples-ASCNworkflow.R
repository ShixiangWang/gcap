# Generated by roxytest: Do not edit by hand!

# File R/ASCNworkflow.R: @testexamples

test_that("Function gcap.ASCNworkflow() @ L88", {
  
  data("ascn")
  data <- ascn
  rv <- gcap.ASCNworkflow(data, outdir = tempdir(), model = "XGB11")
  data$purity <- 1
  rv2 <- gcap.ASCNworkflow(data, outdir = tempdir(), model = "XGB11")
  data$age <- 60
  data$gender <- "XY"
  rv3 <- gcap.ASCNworkflow(data, outdir = tempdir(), model = "XGB32")
  # If you want to use 'XGB56', you should include 'type' column
  data$type <- "LUAD"
  rv4 <- gcap.ASCNworkflow(data, outdir = tempdir(), model = "XGB56")
  # If you only have total integer copy number
  data$minor_cn <- NA
  rv5 <- gcap.ASCNworkflow(data, outdir = tempdir(), model = "XGB11")
  
  # R6 class fCNA --------------------------------
  print(rv)
  print(rv$data)
  print(rv$sample_summary)
  print(rv$gene_summary)
  print(rv$cytoband_summary)
  
  # Create a subset fCNA
  rv_subset <- rv$subset(total_cn > 10)
  nrow(rv$data)
  nrow(rv_subset$data)
  
  rv_subset2 <- rv$subset(sample == "TCGA-02-2485-01")
  nrow(rv_subset2$data)
  unique(rv_subset2$data$sample)
  
  sum_gene = rv$getGeneSummary()
  sum_gene
  mat_gene = rv$getGeneSummary(return_mat = TRUE)
  mat_gene
  
  sum_cytoband = rv$getCytobandSummary()
  sum_cytoband
  mat_cytoband = rv$getCytobandSummary(return_mat = TRUE)
  mat_cytoband
  
  expect_equal(rv, rv2)
  expect_equal(length(rv3), 2L)
  expect_equal(length(rv4), 2L)
  expect_equal(length(rv5), 2L)
  expect_error(gcap.ASCNworkflow(data, outdir = tempdir()))
  expect_is(rv_subset, "fCNA")
  expect_is(rv_subset2, "fCNA")
  expect_is(sum_gene, "data.frame")
  expect_is(mat_gene, "data.frame")
  expect_is(sum_cytoband, "data.frame")
  expect_is(mat_cytoband, "data.frame")
})

